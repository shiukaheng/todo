{"openapi":"3.1.0","info":{"title":"DAG Todo API","description":"Task management with DAG dependencies and real-time updates","version":"0.1.0"},"paths":{"/api/state":{"get":{"summary":"Get State","description":"Get current complete application state (one-shot).","operationId":"get_state_api_state_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AppState"}}}}}}},"/api/state/subscribe":{"get":{"summary":"Subscribe State","description":"Subscribe to real-time state updates via SSE.","operationId":"subscribe_state_api_state_subscribe_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/tasks/subscribe":{"get":{"summary":"Subscribe Tasks","description":"Subscribe to real-time task updates via SSE (deprecated - use /state/subscribe).","operationId":"subscribe_tasks_api_tasks_subscribe_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/tasks":{"get":{"summary":"List Tasks","description":"List all tasks with computed properties.","operationId":"list_tasks_api_tasks_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NodeListOut"}}}}}},"post":{"summary":"Add Task","description":"Create a new task.","operationId":"add_task_api_tasks_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NodeCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NodeOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tasks/{task_id}":{"get":{"summary":"Get Task","description":"Get a single task with computed properties.","operationId":"get_task_api_tasks__task_id__get","parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NodeOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"summary":"Set Task","description":"Update a task's properties.","operationId":"set_task_api_tasks__task_id__patch","parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NodeUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperationResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"summary":"Remove Task","description":"Delete a task and its edges.","operationId":"remove_task_api_tasks__task_id__delete","parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperationResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tasks/{task_id}/rename":{"post":{"summary":"Rename Task","description":"Rename a task (change its ID).","operationId":"rename_task_api_tasks__task_id__rename_post","parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RenameRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperationResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/links":{"post":{"summary":"Link Tasks","description":"Create a dependency: from_id depends on to_id.","operationId":"link_tasks_api_links_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LinkRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DependencyOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"summary":"Unlink Tasks","description":"Remove a dependency.","operationId":"unlink_tasks_api_links_delete","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LinkRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperationResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/init":{"post":{"summary":"Init Db","description":"Initialize the database schema and run migrations.","operationId":"init_db_api_init_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperationResult"}}}}}}},"/api/plans":{"get":{"summary":"List Plans","description":"List all plans with their steps.","operationId":"list_plans_api_plans_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanListOut"}}}}}},"post":{"summary":"Create Plan","description":"Create a new plan.","operationId":"create_plan_api_plans_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/plans/{plan_id}":{"get":{"summary":"Get Plan","description":"Get a single plan with its steps.","operationId":"get_plan_api_plans__plan_id__get","parameters":[{"name":"plan_id","in":"path","required":true,"schema":{"type":"string","title":"Plan Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"summary":"Update Plan","description":"Update a plan's properties.","operationId":"update_plan_api_plans__plan_id__patch","parameters":[{"name":"plan_id","in":"path","required":true,"schema":{"type":"string","title":"Plan Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlanOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"summary":"Delete Plan","description":"Delete a plan.","operationId":"delete_plan_api_plans__plan_id__delete","parameters":[{"name":"plan_id","in":"path","required":true,"schema":{"type":"string","title":"Plan Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperationResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/plans/{plan_id}/rename":{"post":{"summary":"Rename Plan","description":"Rename a plan (change its ID).","operationId":"rename_plan_api_plans__plan_id__rename_post","parameters":[{"name":"plan_id","in":"path","required":true,"schema":{"type":"string","title":"Plan Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RenameRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OperationResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"summary":"Health","description":"Health check endpoint.","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AppState":{"properties":{"tasks":{"additionalProperties":{"$ref":"#/components/schemas/NodeOut"},"type":"object","title":"Tasks"},"dependencies":{"additionalProperties":{"$ref":"#/components/schemas/DependencyOut"},"type":"object","title":"Dependencies"},"has_cycles":{"type":"boolean","title":"Has Cycles"},"plans":{"additionalProperties":{"$ref":"#/components/schemas/PlanOut"},"type":"object","title":"Plans"}},"type":"object","required":["tasks","dependencies","has_cycles","plans"],"title":"AppState","description":"Complete application state (graph + plans)."},"DependencyOut":{"properties":{"id":{"type":"string","title":"Id"},"from_id":{"type":"string","title":"From Id"},"to_id":{"type":"string","title":"To Id"}},"type":"object","required":["id","from_id","to_id"],"title":"DependencyOut","description":"Dependency relationship."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LinkRequest":{"properties":{"from_id":{"type":"string","title":"From Id"},"to_id":{"type":"string","title":"To Id"}},"type":"object","required":["from_id","to_id"],"title":"LinkRequest","description":"Link/unlink request."},"NodeCreate":{"properties":{"text":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Text"},"completed":{"type":"boolean","title":"Completed","default":false},"node_type":{"$ref":"#/components/schemas/NodeType","default":"Task"},"due":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Due"},"id":{"type":"string","title":"Id"},"depends":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Depends"},"blocks":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Blocks"}},"type":"object","required":["id"],"title":"NodeCreate","description":"Node creation request."},"NodeListOut":{"properties":{"tasks":{"additionalProperties":{"$ref":"#/components/schemas/NodeOut"},"type":"object","title":"Tasks"},"dependencies":{"additionalProperties":{"$ref":"#/components/schemas/DependencyOut"},"type":"object","title":"Dependencies"},"has_cycles":{"type":"boolean","title":"Has Cycles"}},"type":"object","required":["tasks","dependencies","has_cycles"],"title":"NodeListOut","description":"Node list response."},"NodeOut":{"properties":{"id":{"type":"string","title":"Id"},"text":{"type":"string","title":"Text"},"node_type":{"$ref":"#/components/schemas/NodeType"},"completed":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Completed"},"due":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Due"},"created_at":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Created At"},"updated_at":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Updated At"},"calculated_value":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Calculated Value"},"calculated_due":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Calculated Due"},"deps_clear":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Deps Clear"},"is_actionable":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Actionable"},"parents":{"items":{"type":"string"},"type":"array","title":"Parents"},"children":{"items":{"type":"string"},"type":"array","title":"Children"}},"type":"object","required":["id","text","node_type","completed","due","created_at","updated_at","calculated_value","calculated_due","deps_clear","is_actionable","parents","children"],"title":"NodeOut","description":"Node response with calculated fields."},"NodeType":{"type":"string","enum":["Task","And","Or","Not","ExactlyOne"],"title":"NodeType","description":"Node type labels."},"NodeUpdate":{"properties":{"text":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Text"},"completed":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Completed"},"node_type":{"anyOf":[{"$ref":"#/components/schemas/NodeType"},{"type":"null"}]},"due":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Due"}},"type":"object","title":"NodeUpdate","description":"Node update request."},"OperationResult":{"properties":{"success":{"type":"boolean","title":"Success"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"}},"type":"object","required":["success"],"title":"OperationResult","description":"Generic operation result."},"PlanCreate":{"properties":{"id":{"type":"string","title":"Id"},"text":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Text"},"steps":{"items":{"$ref":"#/components/schemas/StepData"},"type":"array","title":"Steps","default":[]}},"type":"object","required":["id"],"title":"PlanCreate","description":"Create a plan with steps."},"PlanListOut":{"properties":{"plans":{"additionalProperties":{"$ref":"#/components/schemas/PlanOut"},"type":"object","title":"Plans"}},"type":"object","required":["plans"],"title":"PlanListOut","description":"All plans."},"PlanOut":{"properties":{"id":{"type":"string","title":"Id"},"text":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Text"},"created_at":{"type":"integer","title":"Created At"},"updated_at":{"type":"integer","title":"Updated At"},"steps":{"items":{"$ref":"#/components/schemas/StepData"},"type":"array","title":"Steps"}},"type":"object","required":["id","text","created_at","updated_at","steps"],"title":"PlanOut","description":"Plan response."},"PlanUpdate":{"properties":{"text":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Text"},"steps":{"anyOf":[{"items":{"$ref":"#/components/schemas/StepData"},"type":"array"},{"type":"null"}],"title":"Steps"}},"type":"object","title":"PlanUpdate","description":"Update a plan (text and/or steps)."},"RenameRequest":{"properties":{"new_id":{"type":"string","title":"New Id"}},"type":"object","required":["new_id"],"title":"RenameRequest","description":"Rename request."},"StepData":{"properties":{"node_id":{"type":"string","title":"Node Id"},"order":{"type":"number","title":"Order"}},"type":"object","required":["node_id","order"],"title":"StepData","description":"Step in a plan."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"},"input":{"title":"Input"},"ctx":{"type":"object","title":"Context"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}